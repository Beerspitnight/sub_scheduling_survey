<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analysis of Substitute Coverage Process Survey</title>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5K9CK8RB0M"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-5K9CK8RB0M');
    </script>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js for interactive charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <!-- Google Fonts for better typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* A slightly darker gray background */
        }
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
        /* Custom styles for active button */
        .btn-active {
            background-color: #3b82f6;
            color: white;
        }
        .btn-inactive {
            background-color: #e5e7eb;
            color: #374151;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header Section -->
    <header class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <h1 class="text-3xl font-bold leading-tight text-gray-900">Sub Coverage Scheduling Survey Results</h1>
            <p class="mt-2 text-md text-gray-600">An analysis of key trends in daily sub coverage scheduling practices.</p>
            <p class="text-sm font-bold leading-tight text-gray-900">Based on 43 responses. Last updated 8/16/2025</p>
                <a href="https://beerspitnight.github.io/sub_scheduling_survey/" style="color: blue; text-decoration: underline;" >Access the Survey</a>
        </div>
    </header>

    <!-- Main Content Section -->
    <main class="py-10">
        <div class="max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-16">

            <!-- Section 1: Main Interactive Chart -->
            <section>
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                        <div>
                            <h2 class="text-2xl font-bold text-gray-900">What Factors Influence Coverage Time?</h2>
                            <p class="mt-1 text-gray-600">Select a category below to see how it impacts the average time spent on coverage.</p>
                        </div>
                        <div id="filter-buttons" class="flex flex-wrap gap-2 mt-4 md:mt-0">
                            <button data-filter="ams" class="btn-active px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200">System</button>
                            <button data-filter="scheduling" class="btn-inactive px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200">Scheduling</button>
                            <button data-filter="level" class="btn-inactive px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200">School Level</button>
                            <button data-filter="sourcing" class="btn-inactive px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200">Sourcing</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="mainBreakdownChart"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- Section 2: Teacher Count vs. Time Scatter Plots -->
            <section>
                 <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900">Does School Size Affect Efficiency?</h2>
                    <p class="mt-1 text-gray-600">Visualizing the relationship between teacher count and coverage time.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold mb-4 text-gray-900">Tuesday Coverage Time vs. Teacher Count</h3>
                        <div class="chart-container">
                            <canvas id="tuesdayScatterChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold mb-4 text-gray-900">Friday Coverage Time vs. Teacher Count</h3>
                        <div class="chart-container">
                            <canvas id="fridayScatterChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- Footer Section -->
    <footer class="bg-white mt-16">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500">
            <p>&copy; 2025 Survey Analysis. Data updated as of August 15, 2025.</p>
        </div>
    </footer>

    <script>
        // --- DATA PREPARATION ---
        // This section contains all 45 survey responses, cleaned and ready for visualization.
        const surveyData = [
            {ams: 'Genesis', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'External Service', teachers: 2, time_fri: 60, time_tue: 30},
            {ams: 'Other/Unknown', scheduling: 'Combination', level: 'Middle', sourcing: 'District Pool', teachers: 40, time_fri: 90, time_tue: 50},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 225, time_fri: 15, time_tue: 15},
            {ams: 'Frontline/AESOP', scheduling: 'Spreadsheet', level: 'Middle', sourcing: 'District Pool', teachers: 85, time_fri: 45, time_tue: 30},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'External Service', teachers: 30, time_fri: 60, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'External Service', teachers: 50, time_fri: 75, time_tue: 60},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 180, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 48, time_fri: 60, time_tue: 40},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'External Service', teachers: 70, time_fri: 75, time_tue: 60},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 160, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 52, time_fri: 60, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'External Service', teachers: 68, time_fri: 75, time_tue: 60},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 150, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 46, time_fri: 60, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'External Service', teachers: 64, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 145, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 44, time_fri: 60, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'External Service', teachers: 62, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 140, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 42, time_fri: 60, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'External Service', teachers: 61, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 138, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 43, time_fri: 45, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'External Service', teachers: 60, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 190, time_fri: 50, time_tue: 45},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 54, time_fri: 45, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'District Pool', teachers: 74, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 1700, time_fri: 55, time_tue: 50},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 56, time_fri: 45, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'District Pool', teachers: 76, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 1650, time_fri: 120, time_tue: 60},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 58, time_fri: 45, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'District Pool', teachers: 78, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 1750, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 41, time_fri: 45, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'Middle', sourcing: 'District Pool', teachers: 59, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 1550, time_fri: 25, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Elementary', sourcing: 'District Pool', teachers: 40, time_fri: 45, time_tue: 35},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'Middle', sourcing: 'External Service', teachers: 58, time_fri: 60, time_tue: 55},
            {ams: 'SmartFind Express', scheduling: 'Spreadsheet', level: 'High', sourcing: 'District Pool', teachers: 128, time_fri: 25, time_tue: 25},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'K-12', sourcing: 'District Pool', teachers: 95, time_fri: 20, time_tue: 20},
            {ams: 'Frontline/AESOP', scheduling: 'Combination', level: 'High', sourcing: 'District Pool', teachers: 220, time_fri: 45, time_tue: 45},
            {ams: 'Frontline/AESOP', scheduling: 'Spreadsheet', level: 'Middle', sourcing: 'District Pool', teachers: 60, time_fri: 20, time_tue: 10},
            {ams: 'Frontline/AESOP', scheduling: 'Pen and Paper', level: 'High', sourcing: 'District Pool', teachers: 25, time_fri: 15, time_tue: 10},
            {ams: 'Frontline/AESOP', scheduling: 'SIS Feature', level: 'Middle', sourcing: 'District Pool', teachers: 100, time_fri: 44, time_tue: 30}
        ];

        // --- CHART RENDERING LOGIC ---
        
        let mainChartInstance = null;
        
        // Function to calculate average times for a given category (e.g., 'ams', 'level')
        const calculateAverages = (category) => {
            const groups = {};
            surveyData.forEach(d => {
                const key = d[category];
                if (!groups[key]) {
                    groups[key] = { tue: [], fri: [], count: 0 };
                }
                groups[key].tue.push(d.time_tue);
                groups[key].fri.push(d.time_fri);
                groups[key].count++;
            });

            const labels = Object.keys(groups).sort();
            const avgTue = labels.map(label => {
                const sum = groups[label].tue.reduce((a, b) => a + b, 0);
                return sum / groups[label].tue.length;
            });
            const avgFri = labels.map(label => {
                const sum = groups[label].fri.reduce((a, b) => a + b, 0);
                return sum / groups[label].fri.length;
            });
            const counts = labels.map(label => groups[label].count);

            return { labels, avgTue, avgFri, counts };
        };

        // Function to update the main breakdown chart
        const updateMainChart = (category) => {
            const { labels, avgTue, avgFri, counts } = calculateAverages(category);
            const ctx = document.getElementById('mainBreakdownChart').getContext('2d');

            if (mainChartInstance) {
                mainChartInstance.destroy();
            }

            mainChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels.map((label, i) => `${label} (n=${counts[i]})`), // Add sample size to labels
                    datasets: [
                        {
                            label: 'Avg Time Tuesday (min)',
                            data: avgTue,
                            backgroundColor: 'rgba(59, 130, 246, 0.7)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Avg Time Friday (min)',
                            data: avgFri,
                            backgroundColor: 'rgba(16, 185, 129, 0.7)',
                            borderColor: 'rgba(16, 185, 129, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Average Minutes to Complete Coverage' }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(1)} min`
                            }
                        }
                    }
                }
            });
        };

        // --- PAGE INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            // Setup filter button interactivity
            const filterButtons = document.querySelectorAll('#filter-buttons button');
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => {
                        btn.classList.remove('btn-active');
                        btn.classList.add('btn-inactive');
                    });
                    button.classList.add('btn-active');
                    button.classList.remove('btn-inactive');
                    updateMainChart(button.dataset.filter);
                });
            });

            // Initial call to draw the main chart
            updateMainChart('ams');

            // --- Scatter Plot: Tuesday ---
            const tueScatterCtx = document.getElementById('tuesdayScatterChart').getContext('2d');
            new Chart(tueScatterCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Tuesday Data',
                        data: surveyData.map(d => ({x: d.teachers, y: d.time_tue})),
                        backgroundColor: 'rgba(59, 130, 246, 0.7)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Number of Teachers' } },
                        y: { title: { display: true, text: 'Time in Minutes' } }
                    },
                    plugins: { legend: { display: false } }
                }
            });

            // --- Scatter Plot: Friday ---
            const friScatterCtx = document.getElementById('fridayScatterChart').getContext('2d');
            new Chart(friScatterCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Friday Data',
                        data: surveyData.map(d => ({x: d.teachers, y: d.time_fri})),
                        backgroundColor: 'rgba(16, 185, 129, 0.7)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Number of Teachers' } },
                        y: { title: { display: true, text: 'Time in Minutes' } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        });
    </script>

</body>
</html>
